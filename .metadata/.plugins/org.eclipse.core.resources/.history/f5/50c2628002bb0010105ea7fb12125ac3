// src/vista/FrmListadoClientes.java
package vista;

import dao.ClientesDAO;

import javax.swing.*;
import javax.swing.table.DefaultTableModel;
import java.awt.*;
import java.util.List;

public class FrmListadoClientes extends JFrame {
    private final DefaultTableModel modelo = new DefaultTableModel(
            new Object[]{"ID","Nombre","Email","Edad"}, 0) {
        @Override public boolean isCellEditable(int r,int c){ return false; }
        @Override public Class<?> getColumnClass(int c){
            return (c==0||c==3) ? Integer.class : String.class;
        }
    };

    public FrmListadoClientes() {
        setTitle("Clientes");
        setDefaultCloseOperation(DISPOSE_ON_CLOSE);
        setSize(640, 360);
        setLocationRelativeTo(null);

        JTable tabla = new JTable(modelo);
        JButton refrescar = new JButton("Refrescar");
        refrescar.addActionListener(e -> cargar());

        add(new JScrollPane(tabla), BorderLayout.CENTER);
        add(refrescar, BorderLayout.SOUTH);
        cargar();
    }

    private void cargar() {
        try {
            modelo.setRowCount(0);
            List<Object[]> filas = new ClientesDAO().listarTodos();
            for (Object[] f : filas) modelo.addRow(f);
        } catch (Exception ex) {
            ex.printStackTrace();
            JOptionPane.showMessageDialog(this,
                "Error al listar: " + ex.getMessage(),
                "Error", JOptionPane.ERROR_MESSAGE);
        }
    }
}
