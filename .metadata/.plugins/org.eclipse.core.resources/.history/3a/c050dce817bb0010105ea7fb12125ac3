// src/vista/FrmInicio.java
package vista;

import dao.ClientesDAO;
import dao.DireccionesDAO;
import dao.ContactosDAO;

import javax.swing.*;
import javax.swing.event.DocumentEvent;
import javax.swing.event.DocumentListener;
import javax.swing.table.*;
import java.awt.*;
import java.awt.event.ActionEvent;
import java.util.List;
import java.util.regex.Pattern;

public class FrmInicio extends JFrame {

    public FrmInicio() {
        setTitle("Empresa · One Page (empresa_clientes)");
        setDefaultCloseOperation(EXIT_ON_CLOSE);

        // Tamaño inicial cómodo + mínimo + centrado; intenta abrir maximizado
        Dimension screen = Toolkit.getDefaultToolkit().getScreenSize();
        int w = (int) (screen.width * 0.90);
        int h = (int) (screen.height * 0.85);
        setSize(Math.max(1100, w), Math.max(650, h));
        setMinimumSize(new Dimension(1100, 650));
        setLocationRelativeTo(null);
        setExtendedState(getExtendedState() | JFrame.MAXIMIZED_BOTH);

        // Título
        JLabel titulo = new JLabel("Base de datos: empresa_clientes", SwingConstants.LEFT);
        titulo.setFont(titulo.getFont().deriveFont(Font.BOLD, 18f));
        JPanel header = new JPanel(new BorderLayout());
        header.setBorder(BorderFactory.createEmptyBorder(10,12,4,12));
        header.add(titulo, BorderLayout.WEST);

        // Tabs
        JTabbedPane tabs = new JTabbedPane();
        tabs.addTab("Clientes",    new TabClientes());
        tabs.addTab("Direcciones", new TabDirecciones());
        tabs.addTab("Contactos",   new TabContactos());

        setLayout(new BorderLayout());
        add(header, BorderLayout.NORTH);
        add(tabs, BorderLayout.CENTER);
    }

    /* =============== BASE GENÉRICA PARA PESTAÑAS CRUD =============== */
    abstract class CrudTab extends JPanel {
        protected final JTextField txtBuscar = new JTextField(28);
        protected final JButton btnRefrescar = new JButton("Refrescar");
        protected final JButton btnNuevo     = new JButton("Nuevo");
        protected final JTable tabla         = new JTable();
        protected final DefaultTableModel modelo;
        protected final JPanel editorPanel   = new JPanel(new GridBagLayout());
        protected Integer editId = null; // null = nuevo; !=null = editar

        protected CrudTab(String[] columnas) {
            setLayout(new BorderLayout(0,0));

            // Barra superior
            JPanel izq = new JPanel(new FlowLayout(FlowLayout.LEFT, 8, 0));
            izq.
